import React from "react";
import classNames from "classnames";
import _ from "lodash";

import { ProgressBarLabel } from "../ProgressBarLabel";
import currentPositionStyles from "./ProgressBarCurrentPosition.module.css";
import { indicatorStore } from "@/stores/IndicatorStore.js";
import { observer } from "mobx-react-lite";

const ProgressBarCurrentPosition = observer((props) => {
    const { width, position } = props;

    const {
        progressBarKeys: {
            showCurrentValue,
            showPercentageLabel,
            currentValueLabelPosition,
            color,
        },
        inputCurrentValue,
        indicatorSize,
    } = indicatorStore;

    const currentPositionStyle = {
        width: width.currentValueWidth,
    };

    if (position === "middle") {
        currentPositionStyle.background = color[0];
    }

    const percentageLabelClassName = classNames(
        currentPositionStyles.PercentageLabel,
        currentPositionStyles[indicatorSize],
    );

    return (
        <div
            className={currentPositionStyles.CurrentPosition}
            style={currentPositionStyle}
        >
            {position === "middle" && showPercentageLabel && (
                <div className={percentageLabelClassName}>
                    {width.percentageValue}
                </div>
            )}

            <ProgressBarLabel
                label={inputCurrentValue}
                showValue={showCurrentValue}
                position={position}
                labelPosition={currentValueLabelPosition}
                index={3}
            />
        </div>
    );
});

export default ProgressBarCurrentPosition;
